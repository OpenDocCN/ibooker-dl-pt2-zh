- en: 9 Feature selection
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 特征选择
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Understanding principles for feature selection and feature engineering
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解特征选择和特征工程原则
- en: Applying feature selection principles to case studies
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将特征选择原则应用于案例研究
- en: Sharpening feature selection skills based on case study analysis
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于案例分析磨练特征选择技能
- en: Thus far, you have been using the original (raw) data values from the DC taxi
    data set as the features for your machine learning models. A *feature* is a value
    or a collection of values used as an input to a machine learning model during
    both the training and inference phases of machine learning (see appendix A). *Feature
    engineering*, the process of selecting, designing, and implementing synthetic
    (made-up) features using raw data values, can significantly improve the machine
    learning performance of your models. Some examples of feature engineering are
    simple, formulaic transformations of the original data values, for instance rescaling
    arbitrary numeric values to a range from —1 to 1\. *Feature selection* (also known
    as *feature design*), the initial phase of feature engineering, is the more creative
    part of the effort and involves specification of features that capture human knowledge
    or intuition about the data set, such as choosing a feature that measures the
    distance between pickup and drop-off locations for each ride in the taxi trips
    data set.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，您一直在使用DC出租车数据集的原始（原始）数据值作为机器学习模型的特征。 *特征* 是机器学习模型在训练和推断阶段期间使用的输入值或一组值（请参阅附录A）。
    *特征工程* 是选择、设计和实施使用原始数据值的合成（虚构）特征的过程，可以显着提高模型的机器学习性能。 特征工程的一些例子是对原始数据值进行简单的、公式化的转换，例如将任意数字值重新调整到-1到1的范围。
    *特征选择*（也称为*特征设计*）是特征工程的初始阶段，是工作的更有创意的部分，涉及指定捕获有关数据集的人类知识或直觉的特征，例如选择衡量出租车行程数据集中每次乘车的上车和下车位置之间距离的特征。
- en: 'Indiscriminately adding a large number of features to your project data set
    can be a costly mistake (see the “curse of dimensionality” problem). Feature “over-engineering”
    may result in overfitting as well as in an overall decline of your machine learning
    model performance. Which begs the question: what guiding principles can apply
    to select the right features so that you can avoid the dreaded feature over-engineering?
    This chapter uses case studies to introduce you to these principles and illustrates
    how you can apply them in practice.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 无差别地向项目数据集中添加大量特征可能是一个代价高昂的错误（参见“维度诅咒”问题）。 特征“过度设计”可能导致过拟合以及机器学习模型性能的整体下降。 这引出了一个问题：有哪些指导原则可以帮助选择正确的特征，以避免可怕的特征过度设计？
    本章将使用案例研究来介绍这些原则，并说明如何在实践中应用它们。
- en: This chapter covers three case studies that span the financial, advertising,
    and mobile gaming industries. For each case study, you are given a description
    of a machine learning project for the industry as well as a high-level specification
    of the machine learning model you are expected to train for the project. Then,
    you are given descriptions of candidate features for the project. Finally, a discussion
    section for each case study describes how to apply the five guiding principles
    to help you decide whether you should select the candidate feature.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了三个案例研究，涉及金融、广告和移动游戏行业。 对于每个案例研究，您将得到一个行业的机器学习项目描述，以及您预期为该项目训练的机器学习模型的高级规范。
    然后，您将得到该项目的候选特征描述。 最后，每个案例研究的讨论部分描述了如何应用五个指导原则，以帮助您决定是否应选择候选特征。
- en: 9.1 Guiding principles for feature selection
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征选择的指导原则
- en: 'This section introduces the five guiding principles to help you choose the
    right features for your machine learning project. While I have not seen these
    principles codified as an industry standard, they condense over a decade of my
    experience in selecting features for data science, machine learning, and deep
    learning projects. The remainder of this section explains these guiding principles
    in more detail so that in section 9.2, you can apply them to the case studies
    and to the concrete examples of candidate features. According to these principles,
    a candidate feature should be:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本节介绍了五个指导原则，以帮助你为你的机器学习项目选择正确的特征。虽然我没有看到这些原则被作为行业标准编纂，但它们总结了我在选择数据科学、机器学习和深度学习项目特征方面超过十年的经验。本节的其余部分将更详细地解释这些指导原则，以便在第9.2节中，你可以将它们应用于案例研究和候选特征的具体示例。根据这些原则，一个候选特征应该是：
- en: Related to the label
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与标签相关
- en: Recorded before inference time
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在推断时间之前记录
- en: Supported by abundant examples
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 得到丰富的例子支持
- en: Expressed as a number with a meaningful scale
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 表达为具有有意义刻度的数字
- en: Based on expert insights about the project
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于项目的专业见解
- en: 9.1.1 Related to the label
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1.1 与标签相关
- en: 'This section teaches you what to consider when evaluating a relationship between
    a feature (or a potential feature) and a label so that you can select and prioritize
    features for your feature engineering efforts. Before you decide to include a
    potential feature in a machine learning model training experiment, make sure you
    can articulate a rationale (a justification) explaining why the feature is related
    to the label value. Articulating the rationale can help you convince yourself
    (and in an ideal case, an impartial observer) that the feature is in fact relevant
    to the problem you are attempting to solve using machine learning. Of course,
    some rationales are better than others: “why not?” does not make for a strong
    rationale for a feature. In general, weak rationales translate to an excessive
    quantity of potential features with varying strengths of relatedness to the label.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 本节教你在评估特征（或潜在特征）与标签之间关系时应考虑哪些因素，以便你可以为你的特征工程工作选择和优先考虑特征。在你决定在机器学习模型训练实验中包含一个潜在特征之前，确保你能够表达一个理由（一种证明），解释为什么这个特征与标签值相关联。表达理由可以帮助你说服自己（在理想情况下，一个公正的观察者），这个特征实际上与你尝试使用机器学习解决的问题相关。当然，有些理由比其他理由更好：“为什么不呢？”并不是一个强有力的特征理由。一般来说，弱理由会导致潜在特征的数量过多，并且与标签的相关性强弱不一。
- en: Note that having a rationale for a feature is also important because the relationship
    between the candidate feature and the label can change depending on your problem.
    In practice, changing the question you are answering using a data set can change
    whether a relationship exists between the candidate feature and the label. For
    example, when estimating the taxi fare for a trip across DC, a feature value of
    a distance between the pickup and drop-off locations is related to the taxi fare
    estimate. However, if instead of estimating the taxi fare, you decide to use the
    distance feature to estimate the number of taxi pickups at a given location in
    DC at a given time, then the feature loses the relatedness to the label. While
    it may seem obvious that a feature selected for a different project may become
    useless when changing the label, in practice, training data sets and feature stores
    are re-used across machine learning projects, leading to inadvertent re-use of
    irrelevant and potentially harmful (as illustrated in the rest of this chapter)
    features.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，对于一个特征有一个理由也很重要，因为候选特征与标签之间的关系可能会根据你的问题而改变。在实践中，改变你用数据集回答的问题可以改变候选特征与标签之间是否存在关系。例如，当估算跨越DC的出租车费用时，接送地点之间的距离特征值与出租车费用估算相关。然而，如果你决定不再估算出租车费用，而是决定使用距离特征来估算在DC特定时间的特定位置的出租车接送数量，那么这个特征就失去了与标签的相关性。虽然似乎显而易见，一个为不同项目选择的特征在更改标签时可能变得无用，但在实践中，训练数据集和特征存储库被重新使用于机器学习项目，导致意外重复使用无关和潜在有害（如本章的其余部分所示）的特征。
- en: The meaning of the word *related* when used in this section translates to a
    variety of possibilities; for instance, *statistical correlation* is one kind
    of relatedness. As you know, statistical correlation means that causation may
    or may not play a role in the relationship between a feature and a label.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 当本节中使用的“相关”一词有不同的含义时，其意义也不尽相同，例如，“统计相关”就是其中一种相关性。正如你所知，统计相关性意味着因果关系可能对特征和标记之间的关系起到作用，也可能不起作用。
- en: 'Consider a well-known example: according to the standard Pearson measure of
    statistical correlation, reading ability in children is correlated with their
    shoe size. In other words, according to classical statistics, if you wish to estimate
    a child’s shoe size, you can use the score from the child’s latest reading test.
    Of course, there is no causation in the relationship between the shoe size and
    the reading ability variables; the correlation exists due to the underlying (confounding)
    variable of the child’s age.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个众所周知的例子：根据标准的皮尔逊统计相关度量，儿童的阅读能力与他们的鞋尺码相关。换句话说，根据经典统计学的说法，如果你想要估算一个孩子的鞋码，你可以使用孩子最近一次阅读测试的分数。当然，在鞋尺码和阅读能力变量之间不存在因果关系，因相关性存在于年龄这一潜在（混淆）变量之间。
- en: The shoe size estimate example is illustrated in figure 9.1\. Notice that the
    causal relationship between the child’s age and shoe size, as well as the child’s
    age and the reading score, also translate to statistical correlation between these
    pairs of variables. So, while a statistical correlation between a candidate feature
    and the label can serve as a baseline rationale for the feature, a stronger justification
    can be based on a causal relationship between the feature and the label.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 鞋尺码估算的例子如图9.1所示。注意，孩子年龄与鞋尺码之间的因果关系，以及孩子年龄和阅读成绩之间的因果关系也转化为这些变量对之间的统计相关性。因此，虽然候选特征与标记之间的统计相关性可以作为特征的基线理由，但更强的证明可以基于特征与标记之间的因果关系。
- en: '![09-01](Images/09-01.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![09-01](Images/09-01.png)'
- en: Figure 9.1 A feature can be based on a child’s reading test score or age variables,
    but the age-based feature is more strongly related to the shoe size due to a counterfactual
    causal relationship between the age and the shoe size.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.1 特征可以基于孩子的阅读测试成绩或年龄变量，但基于年龄的特征与鞋尺码之间有更强的相关性，因为年龄与鞋尺码之间存在反事实因果关系。
- en: 'Is it possible to tell correlation apart from causation? It depends on your
    definition of causality. Most contemporary machine learning and data science practitioners
    in the industry and in academia use a kind of causality known as *counterfactual
    causality*.[¹](#pgfId-1012029) You can decide whether a counterfactual causal
    relationship exists between the candidate cause and effect variables by answering
    a hypothetical question: all other things being equal, if an omnipotent actor
    were to intervene to change only the cause, would the effect inevitably change?
    Notice that this kind of causality does not exist for the relationship between
    the reading test scores and the shoe sizes: had someone intervened and changed
    the average test scores for kids of a certain age, their shoe size would not change.
    In contrast, substituting a cohort of younger kids with a cohort of older kids
    translates to both higher average reading test scores (assuming the tests are
    not age-adjusted) and larger average shoe sizes.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 是否可以区分相关性和因果关系？这取决于你对因果关系的定义。大多数现代机器学习和数据科学从业者和学者在业界和学术界都使用一种称为“反事实因果”的因果关系。[¹](#pgfId-1012029)
    你可以通过回答一个假设性问题来决定候选原因和效应变量之间是否存在反事实因果关系：在其他所有条件相同的情况下，如果一个全能的演员只改变原因，那么结果是否必然改变？注意，这种因果关系在阅读测试成绩和鞋尺码之间的关系中不存在：如果有人干预并改变某个年龄段儿童的平均测试成绩，他们的鞋尺码不会改变。相比之下，用一群年龄更小的孩子代替一群年龄更大的孩子，会导致平均阅读测试分数（假设测试没有经过年龄调整）增加，平均鞋尺码也变大。
- en: When articulating the relatedness between a candidate feature and a label, it
    is useful to identify and prioritize features that have counterfactual causal
    relationships to the label over the features that demonstrate a correlation or
    an unclear relationship to the label.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 当阐述候选特征和标记之间的相关关系时，有助于确定并优先考虑与标记存在反事实因果关系的特征，而不是表明与标记之间存在相关性或不明确关系的特征。
- en: 9.1.2 Recorded before inference time
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1.2 推理之前的记录
- en: 'This section teaches you how to navigate around a common pitfall in feature
    selection: using features that are known at training time but are unavailable
    or difficult to obtain once a trained model is deployed to production.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: The feature value you are considering must be available at inference time, once
    your machine learning model is processing data beyond the training and test data
    sets used to create the model. This is an important but often overlooked aspect
    of feature selection, particularly since training data sets are retrospective
    and usually do not contain information about the order in which data values become
    available. For example, a training data set describing the history of a company’s
    sales deals often does not capture the fact that the customer’s name and contact
    information are available to the company prior to the dollar amount of a closed
    sales deal.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: What makes this issue subtle is that retroactively looking at data from past
    events, as recorded in the training data set, the sequencing of the events may
    not be immediately obvious, and you may inadvertently use future information at
    inference time. For example, suppose you are attempting to estimate the weight
    of a newborn baby and one of the candidate features is the duration of pregnancy.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: Note Pre-mature newborns have lower-than-average weights while babies born after
    42 weeks of pregnancy are heavier on average, so the duration of pregnancy in
    terms of the number of the weeks seems to be a useful feature to select.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: You should not be surprised to find the duration of pregnancy (in terms of weeks)
    in the training data set since it is a historical measure that makes sense to
    record at the time of the birth. However, if you are creating a model to estimate
    the expected weight of the newborn during a routine doctor’s visit halfway through
    the pregnancy, the number of the weeks of pregnancy at birth is unknown.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: The example with the estimation of the newborn weight is just one instance of
    an issue known as *data leakage*. Other examples of data leakage include duplication
    of observations across training, validation, and test data sets. In general, data
    leakage occurs when the information about the label value is inadvertently included
    or “leaked” into the training data set. Symptoms of data leakage include inflated
    machine learning model performance on the training data set and even complete
    failures of the model once it is deployed to production. For instance, this issue
    can arise when working with features from the well-known Titanic data set,[²](#pgfId-1013110)
    as illustrated in figure 9.2.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: '![09-02](Images/09-02.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
- en: Figure 9.2 In the subset of features from the Titanic data set, age and gender
    are known before the survival outcome for the passengers. The values for the boat
    and body features are recorded for a passenger depending on whether the passenger
    survived or perished. Hence, boat and body features “leak” data about the survival
    label.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: It is counterintuitive to reason about prediction of past events; however, the
    Titanic data set invites you to do exactly that. You can train a machine learning
    model to predict a binary survival outcome (whether a person survived or perished)
    for passengers on the Titanic during the fateful crossing of the Atlantic in April
    of 1912\. While the entire data set contains 13 features and a label, figure 9.2
    shows just the 4 features that are relevant to this example along with the label
    (survival). The survival label in the data set uses a value of 1 to indicate that
    a passenger survived while the value of 0 represents that a passenger perished.
    The age feature is numeric with the age of the passengers at the time when they
    boarded the ship, while the gender feature is limited to male and female values
    represented using 1 and 0, respectively. The boat and body features are both categorical
    and encoded as strings. The boat feature stores the identifier of the boat (for
    example "11") on which a passenger was rescued. The morbid body feature stores
    values like "328" that specify the identifiers assigned to passengers who perished.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 推理过去事件的预测是违反直觉的；然而，泰坦尼克号数据集恰恰邀请您这样做。您可以训练一个机器学习模型来预测泰坦尼克号在1912年4月横渡大西洋时的乘客的二元生存结果（是否幸存）。虽然整个数据集包含13个特征和一个标签，但图9.2仅显示了与此示例相关的4个特征以及标签（生存）。数据集中的生存标签使用值1表示乘客幸存，而值0表示乘客遇难。年龄特征是数值型的，表示乘客登船时的年龄，而性别特征则限定为男性和女性值，分别使用1和0表示。船和尸体特征都是分类的，并编码为字符串。船特征存储乘客被救的船的标识符（例如“11”）。尸体特征存储类似“328”的值，指定了遇难乘客的标识符。
- en: To avoid the counterintuitive implication of using the word *predict*, it is
    helpful to think about inferring the survival outcome for each passenger when
    considering candidate features for training the machine learning model. From the
    standpoint of time sequencing, it is reasonable to infer survival based on the
    features age and gender because both existed for each passenger prior to their
    survival outcome. This is shown in figure 9.2 using arrows pointing from age and
    gender features to the survived label. Hence, a machine learning model can be
    trained to use age and gender features since both should be available at inference
    time.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免使用“预测”一词带来的违反直觉的含义，在考虑候选特征训练机器学习模型时，将每位乘客的生存结果推断出来是有帮助的。从时间顺序的角度来看，推断基于年龄和性别特征的生存是合理的，因为这两个特征在每位乘客的生存结果之前都存在。图9.2使用从年龄和性别特征指向生存标签的箭头来展示这一点。因此，机器学习模型可以训练使用年龄和性别特征，因为这两个特征应该在推断时可用。
- en: In contrast, once a passenger on the Titanic survived or perished, that passenger
    survived on a rescue boat or ended up with a body tag. This is shown using the
    arrows pointing from the survival label to body and boat features in figure 9.2\.
    Both body and boat feature values should not be used to train a machine learning
    model to infer the survival outcome for passengers on the Titanic. Of course,
    we don’t expect more events like this to occur, and hence such a model will never
    be used to infer survival outcomes for any passengers other than those who traveled
    on the Titanic. The goal of this example is to introduce you to the importance
    of understanding the features in your data set and the time sequencing relationship
    across the features.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，一旦泰坦尼克号上的乘客幸存或遇难，该乘客就会在救生船上幸存或者以尸体标签结束。图9.2使用从生存标签指向尸体和船特征的箭头来展示这一点。尸体和船特征值都不应该用于训练机器学习模型推断泰坦尼克号乘客的生存结果。当然，我们不希望发生类似的事件，因此这样的模型永远不会用于推断除泰坦尼克号乘客之外的任何乘客的生存结果。这个例子的目标是介绍数据集中特征的重要性以及特征之间的时间顺序关系。
- en: In other cases, the feature value may not be available at inference time for
    legal or ethical reasons. For example, for a European Union (EU)-based company
    it is perfectly legal to record the birth date of job applicants. If you are using
    this type of human resources information in the EU to estimate the likelihood
    that an applicant accepts the job offer, the age of the applicant is a reasonable
    feature to select. However, as soon as you attempt to apply the same feature in
    the United States, access to an applicant’s birth date might be against the law
    because, in the US, it is illegal to discriminate on the basis of age when making
    a hiring decision. Moreover, features that leak information about the birth date,
    such as the year of high school or college graduation, can also cause legal concerns
    for the business. So, if you are attempting to adapt a machine learning system
    built in the EU to the United States, you should re-evaluate whether the features
    in the training data set are permitted by your organization. As you can imagine,
    human resources data sets can be full of information (e.g., race or health records)
    but are illegal or unethical as features for training a machine learning model.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在其他情况下，由于法律或伦理原因，在推断时可能无法获得特征值。例如，对于一个总部位于欧盟（EU）的公司，记录求职者的出生日期是完全合法的。如果你在欧盟使用这种类型的人力资源信息来估计求职者接受工作邀约的可能性，求职者的年龄是一个合理的特征选择。然而，一旦你试图在美国应用同样的特征，获取求职者的出生日期可能违法，因为在美国，基于年龄做招聘决定是非法的。此外，泄露有关出生日期的特征，如高中或大学毕业年份，也可能引起企业的法律担忧。因此，如果你试图将在欧盟建立的机器学习系统调整到美国，你应该重新评估培训数据集中的特征是否被你的组织允许使用。正如你可以想象的那样，人力资源数据集可能充满了信息（例如种族或健康记录），但作为机器学习模型的特征则是非法或不道德的。
- en: 9.1.3 Supported by abundant examples
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1.3 丰富的示例支持
- en: This section explores what can go wrong when selecting features that have too
    many missing values or features that have too few distinct values.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 本节探讨了在选择具有太多缺失值或具有太少不同值的特征时可能出现的问题。
- en: It is embarrassingly simple to introduce a feature to a training data set by
    simply adding a column of NaN or NULL values. While such a feature is obviously
    useless, this example serves as a reminder that more does not mean better when
    it comes to increasing the number of features in a training data set. The other
    extreme involves adding features that in combination serve as a unique identifier
    for a label. As a worst-case example for feature engineering, consider a training
    data set for a classification problem where the categorical label takes on 2^N
    distinct values. Since N binary features can encode 2^N possibilities, each of
    the label values might be uniquely identified by the binary values of the N feature
    columns.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 简单地通过添加NaN或NULL值的列将一个特征引入到训练数据集中是非常简单的。虽然这样的特征显然是无用的，但这个例子提醒我们，在增加训练数据集中的特征数量时，更多并不意味着更好。另一个极端情况涉及添加组合起来作为标签的唯一标识符的特征。作为特征工程的最坏情况示例，考虑一个分类问题的训练数据集，其中分类标签有2^N个不同的值。由于N个二进制特征可以编码2^N种可能性，每个标签值可能都可以通过N个特征列的二进制值来唯一标识。
- en: Of course such extreme scenarios of feature over-engineering rarely, if ever,
    occur in practice, but they make convenient reference points for comparison again
    your own feature engineering efforts. For example, if you are selecting a feature,
    do you expect to have a significant fraction (greater than 5%) of the feature
    values in the training data set to have values other than NaN? If you are selecting
    multiple features, would the feature values taken together result in a unique
    identifier for the label value in the training data set but not in the test data
    set?
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，在实践中很少会发生特征过度工程的极端情况，但它们可以作为方便的参考点，用于比较你自己的特征工程工作。例如，如果你正在选择一个特征，你是否期望在培训数据集中有显著比例（大于5%）的特征值不是NaN？如果你选择了多个特征，这些特征值在一起是否会导致在培训数据集中的标签值具有唯一标识符，而在测试数据集中没有？
- en: To answer these questions, you need to ensure that as you are considering candidate
    features you are also maintaining statistics on the missing values of the features
    along with counts of the cross product of the sets of feature values for each
    of the label values.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 要回答这些问题，你需要确保在考虑候选特征时，也要保持对特征缺失值的统计以及每个标签值的特征值集合的交叉乘积计数。
- en: 9.1.4 Expressed as a number with a meaningful scale
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1.4 用具有有意义的比例表达的数字
- en: This section teaches a convenient rule of thumb you can use to check for whether
    a feature can be correctly expressed as a number for using with machine learning
    algorithms.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将教授一个方便的经验法则，用于检查是否将一个特征正确地表达为可用于机器学习算法的数字。
- en: As you know from chapter 1, this book focuses on supervised machine learning
    from structured data sets. For the purposes of feature engineering, this means
    that if the raw data you are planning to use for training machine learning models
    contains unstructured content such as video, images, audio, or natural language
    text, then before you can start with the feature engineering steps described in
    this book, you must convert the corresponding unstructured data values to a numeric
    representation. Specific techniques for these conversions, such as word embeddings
    for natural language text or image classifications for photographic data, are
    outside the scope of this book.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在第一章中了解的那样，本书关注的是从结构化数据集进行有监督机器学习。对于特征工程来说，这意味着如果你计划使用用于训练机器学习模型的原始数据包含视频、图像、音频或自然语言文本等非结构化内容，则在开始进行本书中描述的特征工程步骤之前，必须将相应的非结构化数据值转换为数字表示。这些转换的具体技术，例如自然语言文本的单词嵌入或用于摄影数据的图像分类，超出了本书的范围。
- en: Having a project data set that consists of numeric values is a prerequisite
    to feature engineering since supervised machine learning models amount to sequences
    of arithmetic operations on numeric (either continuous or categorical per the
    the definition in appendix A) feature values to estimate label values. However,
    even if your raw data values are numeric (i.e., expressed using a number) that
    does not mean that the corresponding features that you use to train a machine
    learning model have meaningful numeric scales and magnitudes. If you are not convinced,
    consider that letters A and B are represented as numbers 65 and 66, respectively,
    by the ASCII encoding standard. The sum of the encoding, 131 (65 + 66) corresponds
    to the character â (letter a with a circumflex accent), which is not a meaningful
    result.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 对于特征工程来说，拥有一个由数值组成的项目数据集是前提条件，因为有监督的机器学习模型是对数字（根据附录 A 的定义，可以是连续的或分类的）特征值进行算术操作以估计标签值的序列。但是，即使你的原始数据值是数字（即使用数字表达的），这也不意味着用于训练机器学习模型的相应特征具有有意义的数值比例和大小。如果你不相信，考虑一下字母
    A 和 B 在 ASCII 编码标准中分别表示为数字 65 和 66。编码的总和 131（65+66）对应于字符 â（带有抑扬符的 a 字母），这不是一个有意义的结果。
- en: If you are comfortable applying the formal definitions from figure A.9 in appendix
    A to this example, you should recognize that ASCII encodes a categorical variable
    that describes the finite dictionary of the ASCII characters. As a general rule
    of thumb, you can check whether a numeric value can be treated as a continuous
    variable by performing basic arithmetic operations on the values to confirm whether
    you can obtain meaningful results.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你能够熟练应用附录 A 中图表 A.9 中的正式定义到这个例子中，你应该会认识到 ASCII 编码了一个描述 ASCII 字符有限词典的分类变量。一般而言，你可以通过对这些值进行基本的算术操作来检查数值是否可以被视为连续变量，以确认是否能够获得有意义的结果。
- en: 9.1.5 Based on expert insights about the project
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1.5 基于项目的专业见解
- en: This section describes the most important guiding principle for feature design,
    selection, and engineering—the one that can have the most positive impact on the
    performance of your machine learning model.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了特征设计、选择和工程最重要的指导原则——它可以对你的机器学习模型的性能产生最积极的影响。
- en: When working on machine learning projects with subject matter experts (SMEs)
    who have deep domain expertise in their respective industries, I find that the
    most productive way to encourage the SMEs to propose useful features is to ask
    them, “What information would you share with your team to help them better estimate
    the label value?” This style of conversation motivates the SMEs to take their
    mind away from the complexity of machine learning system design and instead think
    about the problem in natural, human-centric terms. Next, I ask, “How can this
    information be gleaned from the existing data in the project data set?”
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在与具有各自行业深度领域专业知识的主题专家（SMEs）一起开展机器学习项目时，我发现鼓励SMEs提出有用特征的最有效方式是问他们：“您会与团队分享哪些信息以帮助他们更好地估计标签值？”
    这种谈话方式激励SMEs将注意力从机器学习系统设计的复杂性转移到以自然、以人为本的术语思考问题。接下来，我会问：“如何从项目数据集中提取这些信息？”
- en: Taken together, answers to these questions provide a pathway to generate candidate
    features from the project data set. For example, suppose you are working on the
    problem of classifying photos of cars taken in cities around the world to estimate
    whether a photo contains or does not contain a taxi from the respective city.
    While it is possible to set out on a complex engineering exercise, extracting
    text of medallion number, license plates, or other unique taxi identifiers to
    join this information with a municipal data set of taxis, there is an easier path
    forward. Human SMEs who know the city can immediately spot a taxi by color, such
    as yellow in New York City or black in London. This rule of thumb is something
    an SME can easily share with someone who never traveled to the city and help them
    identify a taxi from a sea of cars in a street.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，对这些问题的回答提供了从项目数据集中生成候选特征的途径。例如，假设您正在解决的问题是对世界各地城市拍摄的汽车照片进行分类，以估计照片是否包含该城市的出租车。虽然可以进行复杂的工程演练，提取徽章号码、车牌号码或其他独特的出租车标识符，并将此信息与城市出租车的市政数据集相结合，但有一个更简单的前进路径。了解该城市的人类SMEs可以立即通过颜色辨认出出租车，例如在纽约市为黄色或在伦敦为黑色。这个经验法则是SME可以轻松与从未去过该城市的人分享，并帮助他们在街上的众多汽车中识别出一辆出租车。
- en: Successful feature selection is more than just algorithmic data processing;
    it is a creative process based on applying human common sense about the world
    and insights about the problem domain to the machine learning project. Keep in
    mind that the case study approach in this section can introduce you to the basics
    of ideation and design for feature selection. However, it is not a replacement
    for the real-world experience of putting a machine learning system in production.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的特征选择不仅仅是算法数据处理；它是一种基于对世界的人类常识和对问题领域的洞察的创造性过程，用于机器学习项目。请记住，本节中的案例研究方法可以介绍您了解特征选择的构思和设计基础。但是，这并不能取代将机器学习系统投入生产的真实世界经验。
- en: 9.2 Feature selection case studies
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.2 特征选择案例研究
- en: This section introduces applications of supervised machine learning across three
    different case studies spanning the financial, advertising, and mobile gaming
    industries. In each case study, you will learn about an industry-specific machine
    learning project so that you can learn how to apply feature selection principles
    to other projects.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 本节介绍了在金融、广告和移动游戏行业跨越三个不同案例研究中应用监督机器学习的应用。在每个案例研究中，您将了解一个特定行业的机器学习项目，以便了解如何将特征选择原则应用于其他项目。
- en: '*Financial: Credit card fraud classification*. You are working with a financial
    industry company that issues credit cards to its customers and monitors customer
    credit card transactions for signs of fraud. The purpose of your supervised machine
    learning classification model is to estimate whether a given transaction is fraudulent
    or non-fraudulent. To keep the feature engineering exercise simple, assume that
    you are working with a balanced data set (which isn’t true in production) of fraudulent
    versus non-fraudulent examples, so the accuracy of your classifier is a meaningful
    machine learning model performance metric.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*金融：信用卡欺诈分类*。您正在与一家金融行业公司合作，该公司向客户发行信用卡，并监视客户信用卡交易以寻找欺诈迹象。您监督的机器学习分类模型的目的是估计给定交易是否欺诈或非欺诈。为了使特征工程练习简单化，请假设您正在使用一个平衡的数据集（在生产中并非如此）来处理欺诈与非欺诈示例，因此您的分类器的准确度是一个有意义的机器学习模型性能指标。'
- en: '*Advertising: Online banner advertisement clicks estimation*. You are working
    with an advertising industry company that manages online ad banners for its customers
    and charges them whenever a viewer clicks on the banner. Since the company has
    a tool that designs the banner ads for the customers (for an example of a banner
    ad designer, look at [https://github.com/osipov/banner-designer](https://github.com/osipov/banner-designer)),
    it has a data set of the banner ad designs and the corresponding number of clicks
    that the ad received during the campaign. The purpose of your supervised machine
    learning regression model is to estimate the total number of clicks an ad should
    receive based on the banner design. The features for the model should be selected
    based on the ad content and design settings.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*广告：在线横幅广告点击估计*。你正在与一家广告行业公司合作，为其客户管理在线广告横幅，并在观看者点击横幅时收费。由于该公司有一款为客户设计横幅广告的工具（例如横幅广告设计师示例，请查看[https://github.com/osipov/banner-designer](https://github.com/osipov/banner-designer)），它拥有横幅广告设计和广告活动期间广告收到的点击数的数据集。你监督的机器学习回归模型的目的是根据横幅设计估计广告应该获得的总点击数。模型的特征应该根据广告内容和设计设置进行选择。'
- en: '*Mobile gaming: Churn prediction*. You are working with a rapidly growing mobile
    gaming startup to help them improve customer satisfaction with upgrades to their
    top-selling Shoot’em Up Clash Legends game. The purpose of your supervised machine
    learning regression model is to estimate the total number of customers (game players)
    expected to uninstall the game from their mobile device (i.e., churn) in the next
    week.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*移动游戏：流失预测*。你正在与一家快速增长的移动游戏初创公司合作，帮助他们通过对他们的畅销射击游戏 Clash Legends 进行升级来提高客户满意度。你监督的机器学习回归模型的目的是估计下一周有望从其移动设备上卸载游戏（即流失）的总客户数（游戏玩家）。'
- en: 9.3 Feature selection using guiding principles
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.3 使用指导原则进行特征选择
- en: In this section, for each case study from section 9.2, there are several proposed
    features along with a discussion about whether they should be selected for the
    application. Notice that for every case study, using domain knowledge and some
    common sense helps with the decision about whether to choose the feature.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分中，针对第9.2节的每个案例研究，都提出了几个建议的特征，并讨论了是否应该选择该应用程序。请注意，对于每个案例研究，使用领域知识和一些常识有助于决定是否选择该特征。
- en: 9.3.1 Related to the label
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.1 与标签相关
- en: This section teaches the concepts needed to assess candidate features based
    on how strongly they are related to the label so that you can prioritize and select
    more effective features.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分教授了评估候选特征所需的概念，即它们与标签的关系有多强，以便您可以优先选择更有效的特征。
- en: '**Case study: Credit card fraud classification**'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**案例研究：** 信用卡欺诈分类'
- en: '**Feature:** The number of times the credit card in the transaction was used
    to purchase from the same vendor'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：** 在交易中使用信用卡购买同一供应商的次数'
- en: '**Discussion:** A fraudulent credit card transaction is likely to involve a
    purchase that was not authorized. For example, a fraudster may use the stolen
    credit card to purchase from a fake online store that belongs to the fraudster
    or from a physical vendor that operates without video security or keeps poor records.
    Conversely, if the card was used for many purchases from a vendor in the transaction
    without fraud reports, then the association is less likely. For this feature,
    the association should be clear, and the feature should be selected for the model.'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：** 一笔欺诈性信用卡交易可能涉及未经授权的购买。例如，欺诈者可能使用被盗的信用卡从欺诈者拥有的虚假在线商店购买商品，或者从没有视频监控或保留不良记录的实体供应商购买商品。相反，如果卡在交易中多次用于从供应商购买且没有欺诈报告的情况，则关联性可能较低。对于这个特征，关联应该是明显的，并且应该选择该特征用于模型。'
- en: '**Feature:** The number of milliseconds that the credit card was inserted into
    the credit card reader during the transaction'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：** 在交易期间信用卡插入信用卡阅读器的毫秒数'
- en: '**Discussion:** This is an example of a technical piece of information that
    is often available to a machine learning practitioner but does not translate to
    a valuable feature for the model. Notice that during physical transactions with
    credit cards, sometimes the card is taken out of the reader quickly; other times
    it remains in the reader longer. As long as the transaction completes successfully,
    there is no association between this feature and whether a given transaction is
    fraudulent. Even though you might argue that a fraudster is likely to have stolen
    a batch of cards and cycles though them quickly when making fraudulent transactions,
    recall that the purpose of the model does not classify a batch of transactions
    and instead must classify any single arbitrary transaction. Most transactions
    are non-fraudulent and involve a variety of credit card readers and many users
    who may leave the cards in the reader for arbitrary periods of time. There is
    no clear association in this case to select this feature.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：**这是一个技术性的信息示例，机器学习从业者通常可以获得这些信息，但却不能转化为模型的重要特征。注意，使用信用卡进行实体交易时，有时卡片会很快取出，而有时卡片会停留在读卡器中较长时间。只要交易成功完成，就没有这个特征与某个交易是否欺诈之间的关联。尽管你可能会认为，一个欺诈者很可能窃取了一批卡，并在进行欺诈交易时迅速轮换使用它们，但请记住，模型的目的并不是对一批交易进行分类，而是必须对任何单一的任意交易进行分类。大多数交易都是非欺诈性的，并涉及各种各样的信用卡读卡器和许多用户，他们可能会将卡片在读卡器中停留任意长的时间。在这种情况下，并没有明显的关联选择这个特征。'
- en: '**Feature:** Vendor’s business category in the transaction'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：**交易中供应商的业务类别'
- en: '**Discussion:** It is well known that in the United States it is common for
    a stolen credit card to be used for a small purchase at a gas station so that
    the fraudster can confirm that the card is working as expected. Although other
    associations may not be known at the time of feature selection, it is possible
    that the application of machine learning can uncover associations between specific
    business categories of the vendors and fraudulent transactions.'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：**众所周知，在美国，盗取的信用卡通常会在加油站进行小额购买，以确认卡片的正常使用。尽管在特征选择时可能不知道其他关联性，但机器学习的应用可能会揭示供应商特定业务类别与欺诈交易之间的关联。'
- en: '**Feature:** Expiration date of the credit card'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：**信用卡的过期日期'
- en: '**Discussion:** If this candidate feature simply captures the expiration month
    of the card, and the cards have approximately a uniform chance of having expiration
    months, then there is no reason to believe that an association exists between
    the feature and fraud. Also, capturing just the expiration month and year does
    not indicate whether fraud occurred with an expired card: when a card is expired
    a transaction cannot happen, so it does not need to be classified as fraudulent
    or non-fraudulent. In other words, there is no reason to believe that fraudsters
    somehow target cards expiring in December versus January. However, in the United
    States, there is a potential for fraudulent transactions with credit cards stolen
    out of mailboxes. This means that you can select a more sophisticated feature
    that captures the difference between the date of the transaction and the expiration
    date of the card so that you can detect when fraudulent transactions happen close
    to the date of the card issuance, for example two to five years before the card
    expiry.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：**如果这个候选特征仅仅捕捉了卡的过期月份，而卡片的过期月份大致上有相同的几率，那么就没有理由相信这个特征和欺诈之间存在关联。此外，仅仅捕捉过期月份和年份并不意味着伪造交易发生在一个过期的卡上：当卡到期时，是不会发生交易的，所以不需要将其归类为欺诈或非欺诈。换句话说，没有理由相信欺诈者能够以某种方式盯上在十二月过期的卡而不是一月过期的卡。然而，在美国，从邮箱里盗取信用卡存在潜在的欺诈交易的可能性。这意味着你可以选择一个更复杂的特征，来捕捉交易日期和卡的到期日之间的差异，以便在发生欺诈交易靠近卡发放日期的时候进行检测，例如卡到期前两到五年。'
- en: '**Case study: Online banner advertisement clicks estimation**'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '**案例研究：在线横幅广告点击预估**'
- en: '**Feature:** The price of the item in the banner ad'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：**横幅广告中商品的价格'
- en: '**Discussion:** This is one of the most obvious features that can be selected
    from the ad. The price of the item is likely to be the single most important factor
    in whether an ad viewer has interest in the ad and clicks on the banner. Given
    the strength of the association, this should be a priority feature for your regression
    model.'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The category of the font for the text in the banner ad'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** In this case, the feature is based on the named category of
    the font used in the advertisement, such as Times New Roman or Comic Sans. To
    describe the association of this candidate feature with the label, keep in mind
    that design elements such as fonts elicit an emotional response from viewers.
    Since some fonts can be more or less engaging, a categorical feature capturing
    the type of the font used in the ad can model the nuanced association between
    the engagement generated by the font and the total number of clicks on the ad.
    Of course, this feature should be used in conjunction with the other design elements
    of the ad, including content. For instance, choosing Comic Sans to advertise clown
    apparel is likely to generate more clicks than using that font for a wealth management
    ad.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The number of items left in stock as shown on the banner ad'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** You must have shopped on one of the online retail websites
    and seen a message like “only three left” next to the item you wanted to buy.
    So, would it be appropriate to select a feature indicating the number of items
    shown as left in the inventory on the banner ad? Since you must have seen this
    message on real banner ads, you are probably tempted to pick this feature, but
    what is the association between this feature and the label? The association in
    this case is related to a greater sense of urgency the ad viewer might have after
    seeing the limited stock of the advertised item. The sense of urgency may translate
    to a higher click rate, which is what you are attempting to capture.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The number of advertised items as reported by the inventory system'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion**: Although you might try to make the case that low inventory
    levels for an item are a proxy for popularity, indicating an in-demand item, you
    should think about this feature in terms of many ad campaigns across many different
    banner ads. For example, toy cars are stocked at different quantities than actual
    cars and in different quantities than sheets of paper. Further, the ad viewer
    has no knowledge of the actual number of items stocked for item advertised, so
    there is no association between the decision to click on the ad and the actual
    number of items in stock.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Churn prediction**'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** ZIP code of the customer'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** The geographical location of the players can be associated
    with their potential to churn in the next quarter for a variety of reasons. Some
    reasons are technical: perhaps the networking infrastructure used by the gaming
    server infrastructure results in higher latencies (and hence a poor experience)
    for ZIP codes in the southeast of the United States compared to the customers
    in California’s Bay Area. Other reasons could originate from demographics: some
    ZIP codes have older or younger populations compared to the “sweet spot” for the
    game.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：** 玩家的地理位置与他们在下一个季度流失的潜力可能有各种各样的联系。一些原因是技术性的：也许游戏服务器基础设施使用的网络基础设施会使美国东南部的邮政编码产生更高的延迟（因此增加了不好的体验），而与加州湾区的客户相比。其他原因可能来自人口统计学：与游戏的“甜点”相比，一些邮编有较老或较年轻的人口。'
- en: '**Feature:** USD amount spent on the service per month'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：** 每月花费在服务上的美元金额'
- en: '**Discussion:** Since it is common for mobile games to include both a recurring
    monthly subscription price as well as various options, such as the ability to
    spend money to purchase power-ups, player character decorations, and other options
    to stand out from other players, the amount of money a player spends on the game
    is a proxy for their level of engagement and a measure of how invested they are.
    So, there is a possibility for a complex relationship between the amount of money
    spent and the likelihood of churning in the next quarter. For example, spending
    no money on the game can mean that the player lost interest and is more likely
    to uninstall the game. On the other hand, if the player is overly engaged, spending
    an excessive amount of money (e.g., in the top 0.1% percentile), they are also
    likely to burn out from the game or blame it for consuming too much of their time,
    also leading to uninstalling the game from their device.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：** 由于移动游戏通常包括每月循环订阅价格以及各种选项（例如：花钱购买强化道具，玩家角色装饰和其他选项来在其他玩家中脱颖而出），因此玩家在游戏中花费的金额是其投入程度的代表，也是其投资程度的衡量标准。因此，花费的金额与下一个季度流失的可能性之间存在复杂的关系。例如，不在游戏上花钱可能意味着玩家失去了兴趣，更有可能卸载游戏。另一方面，如果玩家过度投入，花费过多的巨额款项（例如，处于前0.1%的百分位数），他们也很可能因游戏过度消磨时间而精疲力尽，从而卸载他们的设备上的游戏。'
- en: '**Feature:** Number of days until the next tax filing date for the gaming company'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：** 距下一次游戏公司纳税日期的天数'
- en: '**Discussion:** Companies in the United States are required to file quarterly
    and annual tax returns with the Internal Revenue Service, the United States’ tax
    authority. Surprisingly, many companies noticed a correlation between the tax
    filing dates and the changes in the customer churn. Although an internal analyst
    in the company may notice and report this correlation, you should be skeptical
    about this association: do the players even know these dates when making a decision
    to uninstall the date? More likely if the correlation exists, it is about the
    end of the month, when many individuals review their monthly spending and make
    a decision to cut down on nonessential items. Since the IRS tax filing dates coincide
    with the time many individuals re-evaluate their spending, this can show up as
    a spurious correlation between the IRS schedule and the customer churn.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：** 美国的公司必须向美国税务局提交季度和年度纳税申报表。令人惊讶的是，许多公司注意到了纳税日期和客户流失的变化之间的相关性。尽管公司内部分析师可能会注意到并报告此相关性，但您应该对此协会持怀疑态度：玩家在卸载日期时是否甚至知道这些日期？如果存在相关性，更有可能是在月底，当很多人回顾他们的月度支出并决定削减不必要的物品时。由于美国税务局的纳税申报日期与许多人重新评估他们的支出的时间重合，因此这可能表现为美国税务局时间表和客户流失之间的虚假相关性。'
- en: '**Feature:** Number of weeks subscribed to the game'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**特征：** 订阅游戏的周数'
- en: '**Discussion:** Many uninstalls of a game happen shortly after the player installs
    it for the first time and decides against keeping it.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**讨论：** 游戏的许多卸载发生在玩家第一次安装游戏后不久，然后决定放弃它。'
- en: 9.3.2 Recorded before inference time
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.2 推理时间之前记录
- en: This section explains the concept of data leakage, how it may subtly disrupt
    the performance of your machine learning models, and illustrates how effective
    feature selection can help you avoid problems from this.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 本节介绍了数据泄漏的概念，它可能会微妙地破坏您的机器学习模型的性能，并说明了有效的特征选择如何帮助您避免这些问题。
- en: '**Case study: Credit card fraud classification**'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The card was used at the store before'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This information should be available at inference time as physical
    card transactions made with the physical card readers are classified differently,
    with the appropriate information recorded for each transaction.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The store item sold in the transaction is a newly stocked item'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** If you have made credit card purchases, you know that, at the
    transaction level, the details of the purchase are not available to the credit
    card-issuing company. For example, if you are making a purchase at a grocery store
    and are buying a new flavor of CocaCola, the credit card company can’t distinguish
    this information from other purchases at the store; all the items are simply aggregated
    into a single charge, so this would not make a good feature for your machine learning
    model.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Category of the item sold in the transaction'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This may or not be available at inference time. For example,
    if the transaction is for a gas (petrol) purchase, then the category is obvious.
    In other cases, when the purchase is at a general retailer such as Target or Walmart,
    where there are thousands of different item categories, the information it not
    available at inference time.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The card was used at a physical (versus online) location'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This information should be available at inference time as physical
    card transactions made with the physical card readers are classified differently,
    with the appropriate information recorded for each transaction.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Online banner advertisement clicks estimation**'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Total number of items purchased using the discount code'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although this information should be available in the data warehouse
    of the company running the campaign after the campaign has concluded, this information
    cannot be available at inference time.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Number of items purchased using the discount code over the past
    30 days'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** If the company running the ad maintains the transaction data
    about the number of times the discount code was used, then it is possible to maintain
    the *sliding window* of the 30 days’ worth of data and calculate this value for
    any given transaction. Further, by predicting the number of clicks on the banner
    ad with the discount code, it is possible to use this daily value to make a better
    estimate of the total banner ad clicks.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Number of customers who viewed the banner ad about the item'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** For an online banner ad, information should be available from
    a data warehouse or a data analytics source.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The number of items advertised in stock at the manufacturer'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This candidate feature is deliberately chosen to spark a thought-provoking
    discussion about the potential features and the ad engagement. Recall that training
    data sets are historical, based on the data from the past advertising campaigns
    and the actual numbers of banner ad clicks. While you may have historical inventory
    data about the items used in the advertising campaigns at the time of the ad impression
    (when the ad was viewed), should this data be used for a feature in your machine
    learning model? Although you may make the case that low inventory levels indicate
    a popular or in-demand item, you should think about the feature in terms of many
    ad campaigns across many different banner ads. There is no reasonable association
    that you can establish for this feature. Further, obtaining the value for this
    feature at runtime (when performing the inference or producing the estimate),
    can be a technical challenge that outweighs the value from experimenting with
    this association.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Churn prediction**'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Total minutes spent playing the game'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Note that using the word *total* in the description of this
    feature can lead to confusion. For someone who uninstalled the game, the total
    refers to the number of minutes spent playing the game over the entire period
    of having it installed. In contrast, the total for someone who did not uninstall
    the game describes the number of minutes up to the point that their data was recorded
    in the training data set. Once the possibility of the dual interpretation is clear,
    it should also be clear that this feature should not be used, since at inference
    time it is impossible to tell the total number of minutes spent with the game
    for a player who never unsubscribed or uninstalled the game.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Total number of minutes spent playing the game in the past 28
    days'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** With a minor change to restrict the measurement of the number
    of minutes spent with the game to the past 28 days, it is possible to use the
    key idea from the previous feature. Regardless of whether a player churns in the
    next month, it is possible to measure their previous 28 days’ worth of game activity
    and use that as a feature for both training and inference.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Uninstall reason provided by the customer'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** When the player uninstalls the game, they can specify the feedback
    with a reason as to why they decided to uninstall. Clearly this information is
    available only for the players who have uninstalled the game and only after they
    have uninstalled it. Hence, it is not available at inference time and should not
    be used for training the machine learning model.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Customer satisfaction score in three months prior to churn'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** If customer satisfaction is gathered randomly across players,
    including those who uninstalled the game as well as those who kept on playing,
    this is a useful feature to include for inference.'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: 9.3.3 Supported by abundant examples
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This section provides examples of candidate features that may or may not have
    enough values to train a machine learning model to guide you on the use of this
    principle in real-world examples.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: '**Case Study: Credit card fraud classification**'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Distance between the cardholder address and the merchant address'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Having information about the distance between the address of
    the cardholder and the location the transaction took place can be useful when
    classifying fraud. However, to use this feature, a practitioner needs to evaluate
    whether it is feasible to have examples for this feature in practice. Unless the
    customer has been proactive at geocoding the distances at the time of the transaction,
    you should not expect to have enough examples for this feature.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Whether the ZIP codes of the cardholder address and the merchant
    address are the same'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Notice that unlike the feature that attempts to use geocoding
    to estimate the distances between the cardholder and the merchant locations, a
    feature that checks whether the ZIP codes of the merchant and the cardholder match
    can be supported by the customer’s historical transactions data. Since every financial
    transaction should have this feature there should be an abundant number of examples
    for this feature.'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The card was used at the merchant before'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** The financial company maintains a history of transactions for
    a given card, so it is possible to check the previous transactions for whether
    the card was used at a given merchant. An absence of transactions with a merchant
    indicates that the card was not used at the merchant, so for every transaction
    in the data set it is possible to assign either a true or a false value to this
    feature.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Category of item being purchased'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although for some merchants such as gas stations, it is possible
    to uniquely identify the category of the item or items purchased in a transaction,
    many companies maintain proprietary item inventory codes. In general, there is
    no guarantee that a transaction includes information about the items purchased.
    You should not expect to have a sufficient number of examples of the categories
    of the item purchased for a general purpose fraud versus non-fraud classifier.
    However, you may be able to create a more specialized classifier for specific
    subcategories of merchants such as gas stations.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Online banner advertisement clicks estimation**'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The day of the year the advertising campaign started'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** As long as the company managing the banner ad campaigns maintains
    the start and end for the campaign, this date should be available for every training
    example.'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The person viewing the banner ad already purchased the item in
    the ad'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Most of the time, the number of purchases of an item shown
    in a banner ad is less than 0.1% compared to the number of the banner ad views.
    You should not expect to have a significant number of examples where you know
    whether the ad viewer purchased the item.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The discount percentage offered in the banner ad'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Most discount percentages offered in ads are based on a small
    collection of well-known values, such as 10%, 20%, 25%, 50%, 75%, or 90% off.
    You should not expect to see discounts of 27.54% off shown on the banner ad. As
    long as the number of the distinct discount amounts offered across marketing campaigns
    is a small fraction of the training data set, you should have a sufficient number
    of examples for this feature.'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Churn prediction**'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Latitude and longitude of the player’s billing address location'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Since both latitude and longitude of the billing address location
    are unique per the customer billing location, using these values to estimate whether
    the player is going to uninstall the game is a mistake. Unless used with caution,
    the specific coordinate values may produce a model that overfits the training
    data set. The raw latitude and longitude values of the billing address location
    should not be used to predict customer churn.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The number of times the player previously uninstalled the game'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** If a player uninstalled the game in the past, it likely that
    they will again. Notice that an absence of a record of the game uninstall can
    mean that the player never uninstalled it, as long as the gaming platform accurately
    reports uninstall events to the gaming company. Hence, it should be possible to
    select this feature with a value for every training example.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The USD amount the player intends to spend next month on gaming'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although knowing how much a given player has in their budget
    to pay for a mobile game in the next month can be exceptionally useful to estimate
    whether they will churn, it is also highly unlikely that the company will have
    this information for any or any meaningful fraction of the total players.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: 9.3.4 Numeric with meaningful magnitude
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This section compares alternative feature representations to help you chose
    between continuous and categorical features.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Credit card fraud classification**'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** ZIP code of vendor in the transaction'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although the ZIP code in the transaction is an integer number,
    it should be clear that it is not a continuous value to be used as is in the machine
    learning model. If you are not convinced, you can apply the rule of thumb about
    the arithmetic values: adding 10001, a ZIP code for New York City, to 20002, a
    ZIP code for Washington DC, yields a ZIP code of 30003, which is a ZIP code for
    Norcross, Georgia—clearly a meaningless result. The ZIP code value should be encoded
    and treated as a categorical variable.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** The number of times the credit card in the transaction was used
    to purchase from the same vendor'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although it is possible to treat this count as a continuous
    variable and obtain meaningful results, notice that knowing the actual number
    of the times the card was used at a vendor is not particularly meaningful.'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Expiration date of the credit card'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Month and year of the credit card expiration are not useful
    as continuous variables. You can re-encode this information to the number of days
    until expiration, but the raw numeric values for this information are not meaningful.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Online banner advertisement clicks estimation**'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Percent value of the discount, such as 10%, 25%, or 50% off'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** On the surface this appears as a simple numeric feature value.
    However, what about negative values? Is it possible to get a negative 100% discount?
    This should be classified as a categorical feature for relisting feature values.'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Size of the banner ad'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** On the surface, amounts like 400px by 400px or 100px by 400px
    seem like traditional numeric features. However, as the model attempts to both
    extrapolate and interpolate from these values, you may find yourself working with
    unexpected results.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Font used by the banner ad'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Adding or multiplying font values produces meaningless results.
    This is not a continuous but a categorical feature.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Color used for the banner ad font'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Although it is possible to represent color as a combination
    of numbers, for example using red-green-blue values, in this value the feature
    is about predicting the clicks on the ad, so a categorical representation is more
    appropriate, since the color is uniform across the ad and falls into the human-readable
    categories such as blue, black, or green.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Item category identifier discounted by the coupon'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Number categories like 1 for dairy, 3 for canned goods, and
    so on are not meaningful as continuous values and should be re-encoded as categorical
    variables.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Churn prediction**'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Customer average minutes played versus average minutes played
    per user across the user base'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This feature should be encoded as a continuous value. It has
    a meaningful zero value (i.e., when the average of the customer coincides with
    the average for the entire user base) and has a meaningful range from negative
    to positive values.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Number of weeks subscribed to the game'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** This feature should be encoded as a continuous value since
    it can be subdivided into more fine-grained parts.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** Mobile operating system used by the customer (e.g., iOS, Android,
    or other)'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Since there is a finite set of operating systems supported
    by the mobile gaming application, this feature should be encoded as a categorical
    variable.'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: 9.3.5 Bring expert insight to the problem
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This section guides you through examples of expert insights about the domains
    of finance, advertising, and gaming to help you hone your skills on these features
    for more effective machine learning.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: As described in this chapter, although it is technically feasible to select
    a variety of features, not every potential feature contributes to the success
    of a machine learning system, and some can result in more harm than benefit to
    a system. The successful features are those where expert knowledge as well as
    common sense augments the raw data set and simplifies the task of the machine
    learning algorithm by making the relationship between the feature and the label
    values more direct.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Credit card fraud classification**'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** A transaction with a suspect vendor in the past month'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** According to experts, a significant number of fraudulent transactions
    are due to a compromised vendor where an employee steals credit card information
    and later uses the stolen information to commit fraud. Human experts often use
    graph-based analysis, as shown in figure 9.3, to identify vendors suspected of
    facilitating fraud. Figure 9.3 shows that three credit cards that went on to report
    a fraudulent transaction were used in the same suspect vendor, shown on the left
    in bold.'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '![09-03](Images/09-03.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
- en: Figure 9.3 Legitimate credit card transactions with a suspect vendor (on the
    left in bold) led to transactions that were reported as fraudulent (on the right).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: Based on the expert insight, you can use a numeric feature for each vendor of
    the total number of credit cards that reported fraud over the past month.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Online banner advertisement clicks estimation**'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** A score measuring the relevance of the ad topic to the top trending
    topics on Twitter'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** As you probably expect, the number of clicks on an online banner
    ad depends not just on the content of the ad itself but also on its relevance
    to the marketplace. For example, an ad about flashlights is going to generate
    more clicks on the eve of a hurricane’s landfall. Similarly, ads about private
    tennis lessons generate more clicks during the weekend of the Wimbledon finals.
    Based on this insight, you can design a numeric feature that captures the similarity
    between the topic of the words in the online banner ad and the trending topics
    on Twitter during the ad campaign.'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: '**Case study: Churn prediction**'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature:** A number of connections on social networks who play the game.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: '**Discussion:** Video game designers will tell you that peer pressure is one
    of the strongest predictors of whether a player continues to play the game. That’s
    why so many mobile games try to connect to your Facebook and other social media
    accounts: if the game developers know that your “friends” play the game, they
    will know that you are likely to play it too.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: 9.4 Selecting features for the DC taxi data set
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this section, you will learn about expert insights that concern the DC taxi
    fare data set and how to apply these insights to select a set of candidate features
    to use for your machine learning model.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: 'Recall from chapter 4 that the set of features for the DC taxi data set is
    quite sparse: the only raw data available at inference time includes the date
    and timestamp of the start of the trip along with the latitude and longitude coordinates
    for the pickup and drop-off locations of the taxi ride. What insights can you
    bring to the taxi fare estimation problem in order to select the right features?'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: 'In the case of the DC taxi data set, a key expert insight concerns the GPS
    used to specify the location coordinates for the trip. The GPS system is precise
    down to 1 meter (just over 3 feet) from the actual location. However, from the
    standpoint of taxi fare estimation, GPS precision is excessive: as described in
    chapter 2, the business rules for the taxi rides use the granularity of 1/8th
    of a mile for pricing. This corresponds to a roughly 200-meter (or about 660 feet)
    precision for a location. The pricing precision is about two orders of magnitude
    more coarse than what’s estimated by the GPS coordinates. Hence, features for
    this data set could include a more coarse representation of the taxi pickup and
    drop-off coordinates.'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: The boundaries of the locations for the taxi rides in the DC taxi data set are
    specified using minimum and maximum values for the latitude and longitude coordinates.
    How can these minimum and maximum values be used for features? The illustration
    in figure 9.4 explains the concept behind the coarse-gained representation of
    the pickup and drop-off coordinates.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: '![09-04](Images/09-04.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
- en: Figure 9.4 Original minimum and maximum latitude and longitude coordinates (left)
    can be used to engineer numeric features based on binning of the coordinates (right).
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: For clarity, the actual DC taxi data set’s minimum and maximum values for the
    latitude and longitude coordinates are replaced with a more convenient set of
    numbers. Although these made-up coordinate numbers are in close proximity to Washington,
    DC, they were picked to make the explanation easier. Hence, both the left and
    the right side in figure 9.4 assume that the coordinates for all the trips in
    the DC taxi data set range from 38.30 to 38.90 along the latitude (north-south)
    and from –76.48 to –76.12 along the longitude (east-west) coordinates.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: 'In addition to using the raw latitude and longitude values to train the machine
    learning model, features for a coarse-grained representation of the pickup and
    drop-off coordinates can use the concept of *binning* (also known as *discretization*
    or *quantanization*) the GPS coordinate values, as illustrated on the right side
    of figure 9.4, which assumes that both the latitude and the longitude coordinates
    were “binned” into three bins each, corresponding to three equally sized intervals:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: (38.30, 38.50), (38.50, 38.70), and (38.70, 38.90) for the latitude
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: (–76.48, –76.36) (–76.36, –76.24), and (–76.24, –76.12) for the longitude
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The diagram on the right side of figure 9.4 indexes each of the three bins using
    integers 0, 1, and 2\. As the result, each of the nine coarse-grained locations
    can be represented using a pair of integers. For example, a taxi ride from a pickup
    location (38.31, -76.47) to a drop-off location (38.61, -76.14) can be represented
    using the locations (0, 0) and (2, 1), respectively. Keep in mind that the selection
    of nine locations is arbitrary. Since it is unclear how coarse the location boundaries
    should be, ultimately the selection of the coarseness for the coordinates should
    be measured by how well the corresponding features help the model to predict the
    taxi fare.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: In the upcoming chapters, you will learn how to apply feature engineering techniques
    to implement the coarse-grained pickup and drop-off location features described
    in this section. Note that while the features based on the expert insight about
    the coarse-grained location representation do not guarantee improved taxi fare
    estimation, the features can be used during the iterative process of machine learning
    model development and can be evaluated in terms of their impact on the machine
    learning model performance metrics.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Effective feature engineering can make the difference between a mediocre and
    a successful machine learning system.
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Although feature selection is more of an art than a science, a machine learning
    practitioner can learn the skills needed to identify the right features for a
    machine learning system by practicing guiding principles to real-world examples.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Case studies in this chapter help machine learning practitioners learn how to
    consistently apply the feature selection principles to case studies from diverse
    industries, including financial, advertising, and mobile gaming.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Successful feature engineering complements the raw training data with carefully
    selected and designed features that incorporate commonsense knowledge and expert
    insights about the machine learning problem.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '^(1.)Counterfactual causality is closely related to the potential outcomes
    definition of causality. Judea Pearl et al.’s book, *Causal Inference in Statistics:
    A Primer* (Wiley, 2016), is a great resource with a more formal treatment of causality.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: ^(2.)The Titanic data set, along with documentation, is available from [https://www.openml.org/d/40945](https://www.openml.org/d/40945).
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
