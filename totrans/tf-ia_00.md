# 前言

## 前言

如今，很难找到一个不受机器学习驱动或至少不受其影响的真实世界系统或产品。机器学习在提升用户体验、削减成本和增加公司收益方面发挥着至关重要的作用。TensorFlow 是一个机器学习框架，使开发人员能够快速为各种定制用例开发机器学习解决方案。如果您是一名机器学习实践者，甚至是一名触及机器学习系统的软件工程师，了解 TensorFlow 是值得的，因为它被数百万开发人员用于构建机器学习解决方案。

本书将带领您进行一次信息丰富的旅程，涵盖了大多数流行的机器学习任务以及最先进的模型。您将了解图像分类和分割，以及各种自然语言处理任务，例如语言建模和情感分析。在此过程中，我们将努力保持我们的代码生产质量。这意味着我们将探索我们可以标准化代码和模型的方法，例如构建强大的端到端数据管道，可以处理常见的数据类型，例如图像和文本。我们还将注意其他重要的方面，例如模型的可解释性、类似任务的当前最先进性能等等。我们以 TensorFlow 如何用于构建生产级机器学习管道以为开发人员提供流畅的操作体验结束了本书。

TensorFlow 有良好的文档覆盖范围（尽管某些主题可能需要更好的文档），并且免费提供。也许你会想知道，为什么你还需要这本书。TensorFlow 已经发展成一个复杂的生态系统，其中有许多组成部分。对于初学者来说，很容易在文档中迷失方向，并浪费时间（如果不是天数）。新功能和新版本发布的速度加剧了这个问题。因此，有一个资源能够整合 TensorFlow 的最新和最重要的信息以及最佳实践，并将其呈现为一篇易于理解、解释清晰的文本，对于解决这个问题是有帮助的。

阅读完本书后，您将了解如何构建大多数常见的机器学习模型，例如卷积神经网络、循环神经网络和 Transformer。您将了解通用的机器学习生命周期以及如何将其应用于许多不同的任务。此外，您还将熟悉构建数据管道，可以在几行代码中执行复杂的转换。

我希望读者在他们的机器学习职业生涯中取得成功，并真诚地希望他们能从本书涵盖的各种主题中获益匪浅。

## 致谢

首先，我要感谢我的父母和我的妻子 Thushani，在整个旅程中一直支持我，并始终站在我的身边。我还要感谢 Manning 的编辑们为我提供的所有支持和鼓励。也感谢 Manning 的制作人员提供的宝贵指导。

致所有抽出时间阅读我的手稿并提供反馈的审稿人：Alessandro Buggin、Amaresh Rajasekharan、Biswanath Chowdhury、Brian Griner、David Cronkite、Dhinakaran Venkat、Eduardo Paluzo Hidalgo、Francisco Rivas、Ganesh Swaminathan、Geoff Clark、Gherghe Georgios、Giri S、Jason Hales、José Antonio Quiles、Joshua A McAdams、Kaniskha Tyagi、Kelvin D. Meeks、Kim Falk Jørgensen、Krzysztof Je˛drzejewski、Lawrence Nderu、Levi McClenny、Nguyen Cao、Nikos Kanakaris、Peter Morgan、Ryan Markoff、Sergio Govoni、Sriram Macharla、Tiklu Ganguly、Todd Cook、Tony Holdroyd、Vidhya Vinay、Vincent Ngo、Vipul Gupta、Vishwesh Ravi Shrimali 和 Wei Luo，感谢您的建议，帮助使这本书变得更好。

## 关于本书

在本节中，我们将讨论这本书适合谁，不同章节及其内容，以及您可以找到代码的位置。

### 谁应该阅读这本书？

你必须确定这本书适合你。这本书是为机器学习社区中的广泛受众编写的，以提供低门槛的入门机会，因此初学者以及具有基本到中级知识和经验的机器学习从业者可以进一步提高他们的 TensorFlow 技能。要从本书中获得最大收益，您需要以下内容：

+   在模型开发生命周期中有经验（通过研究/行业项目）。

+   在 Python 和面向对象编程（OOP）方面具有适度的知识（例如，类、生成器、列表推导）。

+   对 NumPy/pandas 库有基本的了解（例如，计算汇总统计信息，pandas series DataFrame 对象是什么）。

+   对线性代数有基本的了解（例如，基本数学、向量、矩阵、n 维张量、张量运算等）。

+   对不同深度神经网络的基本了解。

但是，如果您具有以下任何经验，您也将从本书中受益匪浅：

+   至少有几个月的机器学习研究员、数据科学家或机器学习工程师的经验，甚至是使用机器学习进行大学或学校项目的学生。

+   有与其他机器学习库（例如，scikit-learn）密切合作的经验，听说过深度学习的惊人成就，并且渴望学习更多有关如何实现它们的知识。

+   有基本的 TensorFlow 功能使用经验，但希望提高自己的水平以编写更好的 TensorFlow 代码。

### 本书的组织结构：一份路线图。

《TensorFlow 实战》分为三个部分和 15 章，第一部分从基础知识开始，第二部分进入中等复杂的主题，机器学习从业者应该对此感到舒适，第三部分涵盖了高级机器学习模型、库和工具。

第一部分重点介绍了 TensorFlow 的基本原理，以及如何实现简单的、精简的机器学习模型，如卷积神经网络、循环神经网络和 Transformer：

+   第一章介绍了 TensorFlow，介绍了 ML 中使用的不同类型的硬件及其权衡，以及何时以及何时*不*使用 TensorFlow。

+   第二章详细介绍了 TensorFlow 在内部的工作原理，TensorFlow 中找到的不同构建模块，以及如何实现 TensorFlow 中使用的一些常见操作，如卷积。

+   第三章讨论了 Keras，这是 TensorFlow 中用于轻松构建 ML 模型的子库，以及如何将数据加载到 TensorFlow 中。

+   第四章首次介绍了建模。在这一章中，我们构建了一个全连接网络、一个卷积神经网络和一个循环神经网络。

+   第五章将我们带入了深度学习的皇冠明珠：Transformer 模型以及它们的运作原理。

第二部分介绍了几种流行的机器学习任务以及这些任务上性能最佳的模型：

+   第六章讨论了第一个用例：图像分类。在这一章中，我们使用了一个复杂的 CNN 模型，并对其进行了图像分类数据集的训练。

+   在第七章，我们深入探讨了更高级的主题，如正则化、更复杂的模型以及模型解释技术。

+   第八章向我们介绍了图像分割，这是一种重要的技术，能够赋予自动驾驶汽车更强大的能力。我们将训练一个模型，根据像素所属的对象类别来分割图像像素。

+   第九章是我们深入研究自然语言处理任务的第一步。在这里，我们将训练一个模型，对电影评论中表达的情感进行分类。

+   在第十章，我们更仔细地研究了语言建模任务，这是当今成功的 Transformer 模型的核心。在这里，我们利用语言建模任务构建了一个能够生成故事的模型。

第三部分深入探讨了更高级的主题，如在 TensorFlow 中使用 Transformer 模型和 TensorBoard 监视和将 ML 工作流投入生产：

+   第十一章讨论了序列到序列模型，这是 Transformer 模型的前身，在机器翻译等任务中取得了成功。在这里，我们将训练一个序列到序列模型，将英语翻译成德语。

+   在第十二章，我们继续讨论序列到序列模型，并向读者介绍了一个非常重要的概念：注意力机制。我们将学习如何将注意力机制纳入我们的模型中，这将有助于提高性能并产生富有洞见的可视化效果。

+   第十三章延续了我们在第五章关于 Transformer 的讨论。在这一章中，我们使用 Transformer 模型解决了两个自然语言处理任务：垃圾邮件分类和问题回答。您还将介绍 Hugging Face 的 Transformers 库。

+   第十四章重点介绍了 TensorFlow 随附的一个方便工具：TensorBoard。TensorBoard 对于监视和跟踪模型性能至关重要。它还可以用于可视化数据和性能分析。

+   第十五章，即最后一章，重点介绍了构建生产质量的机器学习流水线。TensorFlow 提供了一个名为 TFX 的库，它提供了一个 API 来将复杂的机器学习工作流标准化为一系列步骤。

您可以根据自己的技能水平选择不同的方法来充分利用本书。例如，如果您是一名在使用 TensorFlow 领域工作了几年（例如 1-3 年）的从业者，您可能会发现第三部分比前面的部分更有用。如果您是初学者，按照时间顺序阅读所有章节是最合理的做法。

### 有关代码

本书包含许多源代码示例，包括编号列表和与普通文本一起排列的示例。在这两种情况下，源代码都以固定宽度的字体格式化，以将其与普通文本分开。有时，代码也会以**粗体**显示，以突出显示与章节中先前步骤中已更改的代码，例如当新功能添加到现有代码行时。

在许多情况下，原始源代码已经被重新格式化；我们已经添加了换行符并重新排列了缩进以适应书中的页面空间。在极少数情况下，即使这样做也不够，列表中还包括了行延续标记（➥）。此外，在文本中描述代码时，源代码中的注释通常会被从列表中删除。代码注释会伴随许多列表出现，突出显示重要概念。

您可以在本书的在线版本 liveBook（在线版）中获取可执行代码片段，网址为 [`livebook.manning.com/book/tensorflow-in-action/`](https://livebook.manning.com/book/tensorflow-in-action/)。本书除第一章外的所有章节都附带了代码。完整的代码可在 Manning 网站 ([www.manning.com](http://www.manning.com)) 和 GitHub 上找到，网址为 [`github.com/thushv89/manning_tf2_in_action`](https://github.com/thushv89/manning_tf2_in_action)。

### liveBook 讨论论坛

购买《TensorFlow 实战》包括免费访问 Manning 的在线阅读平台 liveBook。使用 liveBook 的独家讨论功能，您可以在全书范围或具体章节或段落中附上评论。您可以轻松地为自己做笔记，提出技术问题，并获得作者和其他用户的帮助。要访问论坛，请访问[`livebook.manning.com/book/tensorflow-in-action/discussion`](https://livebook.manning.com/book/tensorflow-in-action/discussion)。您还可以了解有关 Manning 论坛以及守则的更多信息，请访问[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)。

Manning 致力于为读者提供一个有意义的对话场所，使读者与作者之间、读者之间的交流得以进行。这不是要求作者必须参与的承诺，作者对论坛的贡献是自愿的（也没有报酬）。我们建议您向作者提出一些具有挑战性的问题，以保持他的兴趣！论坛和以前的讨论档案将可通过出版商的网站访问，只要书还在印刷。

## 关于作者

![Author_Ganegedara](img/Author_Ganegedara.png)

Thushan Ganegedara 是一位经验丰富的机器学习实践者，拥有四年以上的行业经验。目前，他是澳大利亚创业公司 Canva 的高级机器学习工程师，Canva 创立了在线视觉设计软件 Canva，服务着数百万客户。他的工作重点集中在搜索和推荐组上。在加入 Canva 之前，Thushan 是澳大利亚保险公司 QBE Insurance 的高级数据科学家，在该公司开发与保险索赔相关的机器学习解决方案。他还带领团队开发了一个 Speech2Text 管道。Thushan 在悉尼大学获得了机器学习专业的博士学位。

## 关于封面插图

《TensorFlow 实战》封面上的图像题注为“贝尔恩周围的牛奶女仆”，取自 Jacques Grasset de Saint-Sauveur 于 1797 年出版的一套手绘插图集。每幅图都是精美且手工着色。

在那个时代，通过服装即可轻松辨识居住地和职业。Manning 基于历史上丰富多样的地区文化制作书籍封面，庆祝计算机业的创新和进取精神，援用了像这样的插图集将古老的文化重现于人们眼前。
